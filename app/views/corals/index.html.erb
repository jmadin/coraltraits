<% provide(:title, 'Corals') %>


<div class="page-header">
  <h1>Corals</h1>
</div>

<%= render "shared/instructions" %>

<div class="well">
	<div class="row">
	  <div class="col-md-6">
			<%= form_tag corals_path, :method => 'get' do %>
		    <div class="input-group">
		      <%= text_field_tag :search, params[:search], :placeholder => "Search species...", class: "form-control" %>
		      <span class="input-group-btn">
				    <%= submit_tag "Search", :name => nil, class: "btn btn-default" %>
						<%= link_to "See All", corals_path(search: params[:search], pp: "all"), class: "btn btn-warning" %>
						<%= link_to 'Reset', corals_path, class: "btn btn-default" %>
		      </span>
		    </div>
			<% end %>
			<br>Download coral species list as a <%= link_to "csv", corals_path(format: "csv") %>.
	  </div>
	  <div class="col-md-6">
			<% if signed_in? && current_user.admin? %>	
				<%= link_to 'New Coral', new_coral_path, class: "btn btn-primary btn-md pull-right" %>
			<% else %>
			<%# if signed_in? && current_user.contributor? %>	
	  		<strong>Note to Contributors and Editors:</strong> The list of coral species is tightly controlled due to the complex and changing nature of coral taxonomy (see <%= link_to "Procedures", procedures_path %>). If you believe a species is missing from the list, please try searching for the species and try different spellings because we keep track of alternative names. If the species can't be found, please make a request by email to have it added (see <%= link_to "Editors", editors_path %>).
			<% end %>
	  </div>
	</div>
</div>

<%= will_paginate @corals %>

<%= form_tag export_corals_path do %>

	<%= render "shared/download_options" %>			

	<div class="row">
	  <div class="col-md-12">
			<ul class="list-group">
		    <% @corals.each do |coral| %>
				  <li class="list-group-item">							
						<div class="row">
			        <div class="col-md-1" style="color: lightgrey;">
			        	<%= coral.id %>
			        </div>
			        <div class="col-md-5">
			        	<em><%= link_to coral.coral_name, coral %></em>
			        </div>

						 	<div class="col-md-1">
								<%= check_box_tag "checked[]", coral.id %>
							</div>

							<div class="col-md-2">
								<% if not params[:pp] %>
									<%= render "shared/access_counts", :acc => Observation.where(:coral_id => coral) %>
								<% end %>
							</div>

			        <div class="col-md-3">
						    <div class="btn-group pull-right">
						     	<%= link_to 'Show', coral_path(coral), class: "btn btn-xs btn-default" %>
								  <% if signed_in? && current_user.admin? %>
					        	<%= link_to 'Edit', edit_coral_path(coral), class: "btn btn-xs btn-default" %>
					        	<%= link_to 'Delete', coral, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-xs btn-danger" %>
									<% end %>
				        </div>
							</div>
						</div>
					</li>
		    <% end %>		
	    </ul>
		</div>
	</div>
<% end %>





