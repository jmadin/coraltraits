<% provide(:title, 'Methodologies') %>

<div class="row">
  <div class="col-md-8 col-md-offset-2">

		<h3>Listing Methodologies</h3>

		<p>Data for each of the methodologies listed below can be downloaded by selecting them using the checkbox and clicking <code style="color:green;">Download</code>.  Only public trait data will be downloaded for each coral.</p>
		
		<div class="well">
			<% if signed_in? && current_user.contributor? %>	
				<%= link_to 'New Methodology', new_methodology_path, class: "btn btn-primary btn-md pull-right" %>
			<% end %>
			
			<div class="row">
			  <div class="col-lg-6">
					<%= form_tag methodologies_path, :method => 'get' do %>
				    <div class="input-group">
				      <%= text_field_tag :search, params[:search], :placeholder => "Search methodologies...", class: "form-control" %>
				      <span class="input-group-btn">
						    <%= submit_tag "Search", :name => nil, class: "btn btn-default" %>
								<%= link_to 'Reset', methodologies_path, class: "btn btn-default" %>
				      </span>
				    </div>
					<% end %>
			  </div>
			</div>

			<br/>Download methodology list as a <%= link_to "csv", methodologies_path(format: "csv") %>.

		</div>


		<%= form_tag export_methodologies_path do %>

			<table class="table table-condensed">
			  <thead>
			    <tr>
			      <th style="color: lightgrey;">ID</th>
			      <th>Methodology name</th>
			      <th style="text-align:center;"><%= submit_tag "Download", class: "btn btn-success btn-sm" %></th>
			      <th></th>
			    </tr>
			  </thead>

			  <tbody>
			    <% @methodologies.each do |methodology| %>
			      <tr>
			        <td style="color: lightgrey;"><%= methodology.id %></td>
			        <td><em><%= link_to methodology.methodology_name, methodology %></em></td>

						 	<td style="text-align:center;">
								<%= check_box_tag "checked[]", methodology.id %>
							</td>						

			        <td style="text-align:right; min-width: 150px;">
								<% if signed_in? && current_user.contributor? %>
				        	<%= link_to 'Edit', edit_methodology_path(methodology) %>
								<% end %>
							  <% if signed_in? && current_user.admin? %> |
				        	<%= link_to 'Delete', methodology, method: :delete, data: { confirm: 'Are you sure?' } %>
								<% end %>
							</td>
			      </tr>
			    <% end %>
			  </tbody>
			</table>

		
		<% end %>

	</div>
</div>





