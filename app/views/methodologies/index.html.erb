<% provide(:title, 'Methodologies') %>

<div class="col-md-9">
  <%= render "shared/index_header" %>
</div>

<%= form_tag export_methodologies_path do %>

  <div class="col-md-3">
		<%= render "shared/download_options" %>
	</div>

  <div class="col-sm-12">
	
		<%= will_paginate @methodologies, :inner_window => 1, :outer_window => 0 %>

		<ul class="list-group">
    	<% @methodologies.sort_by{|e| e[:methodology_name]}.each do |methodology| %>
			  <li class="list-group-item">							
					<div class="row">
		        <div class="col-sm-1" style="color: lightgrey;">
		        	<%= methodology.id %>
		        </div>
		        <div class="col-sm-5">
        			<%= link_to methodology.methodology_name, methodology %>
		        </div>

		        <div class="col-sm-3">
						</div>

					 	<div class="col-sm-3">
					 		<p class="pull-right">
								<% if not params[:all] %>
			        		<%= render "shared/access_counts", :acc => Observation.where(:id => Measurement.where(:methodology_id => methodology).map(&:observation_id)) %>
								<% end %>
								<%= check_box_tag "checked[]", methodology.id %>
								</p>
						</div>

					</div>
				</li>
	    <% end %>		
    </ul>
		
		<%= will_paginate @methodologies, :inner_window => 1, :outer_window => 0 %>
	</div>
<% end %>


<% if @methodologies.blank? %>
  <div class="alert alert-danger" role="alert">No methodologies entered.</div>
<% end %>

<div class="col-sm-12">
	<p>Download methodologies list as a <%= link_to "csv", methodologies_path(format: "csv", search: params[:search], page: params[:page], all: params[:all]) %>.</p>
</div>
