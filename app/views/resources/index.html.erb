<% provide(:title, 'Resources') %>

<div class="row">
  <div class="col-md-10 col-md-offset-1">

		<h3>Resources</h3>

		<div class="well">
			<div class="row">
			  <div class="col-md-6">
					<%= form_tag resources_path, :method => 'get' do %>
				    <div class="input-group">
				      <%= text_field_tag :search, params[:search], :placeholder => "Search resources...", class: "form-control" %>
				      <span class="input-group-btn">
						    <%= submit_tag "Search", :name => nil, class: "btn btn-default" %>
								<%= link_to 'Reset', resources_path, class: "btn btn-default" %>
				      </span>
				    </div>
					<% end %>
			  </div>
			  <div class="col-md-6">
			  	<% if signed_in? %>	
						<%= link_to 'New Resource', new_resource_path, class: "btn btn-primary btn-md pull-right" %>
					<% end %>
			  </div>
			</div>

			<br/>Download resource list as a <%= link_to "csv", resources_path(format: "csv") %>.

		</div>

		<table class="table table-condensed">
		  <thead>
		    <tr>
		      <th style="color: lightgrey;"><%= sortable "id", "ID" %></th>
		      <th><%= sortable "author", "Author" %></th>
		      <th><%= sortable "year", "Year" %></th>
		      <th><%= sortable "title", "Title" %></th>
		      <th>Obs</th>
		      <th></th>
		    </tr>
		  </thead>

		  <tbody>
		    <% @resources.each do |resource| %>
		      <tr>
		        <td style="color: lightgrey;"><%= resource.id %></td>
		        <td style="max-width: 150px;overflow:hidden;"><%= resource.author %></td>
		        <td><%= resource.year %></td>
		        <td style="max-width: 250px;overflow:hidden;"><%= resource.title %></td>
		        <td><%= Observation.where(:resource_id => resource).size %></td>
						<td style="text-align:right; ">
							<div class="btn-group">
				        <%= link_to 'Show', resource, class: "btn btn-sm btn-default" %>
				        <% if signed_in? && current_user.admin? %>
				        	<%= link_to 'Edit', edit_resource_path(resource), class: "btn btn-sm btn-default" %>
				        	<%= link_to 'Delete', resource, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-sm btn-danger" %>
				        <% end %>
							</div>
		        </td>
		      </tr>
		    <% end %>
		  </tbody>
		</table>

	</div>
</div>
