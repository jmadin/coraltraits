<% provide(:title, 'Meta') %>
<small>

<%= form_tag meta_path, :method => 'get' do %>
  <%= select_tag :status, options_for_select(Trait.all.map(&:release_status).uniq, params[:status]), onchange: "$(this).parent('form').submit();" %>
<% end %>

	<h3><%= params[:status].humanize %></h3>

	<table class="table table-condensed">
		<tr style="background-color:#9DBB5E">
		  <th>Trait Name</th>
		  <th>Class</th>
		  <th style="width:200px;">Description</th>
		  <th>Editor</th>
		  <th>Measurements</th>
		  <th>Standard</th>
		  <th>Value range</th>
		  <th>Value type</th>
		  <th>Methods</th>
		  <th style="width:200px;">Resources</th>
		  <th></th>
		</tr>
		<% @traits.sort_by{ |h| h[:trait_name] }.each do |trait| %>
			<tr>
			  <td><%= link_to trait.trait_name, "/traits/" + trait.id.to_s %></td>
			  <td><%= trait.trait_class %></td>
			  <td><%= trait.trait_description %></td>
			  <td><%= trait.user.name %></td>
			  <td><%= Measurement.where(:trait_id => trait.id).size %></td>
			  <td><%= trait.standard.standard_name %> (<%= trait.standard.standard_unit %>)</td>
			  <td><%= trait.value_range %></td>
			  <td><%= Measurement.where(:trait_id => trait.id).map(&:value_type).compact.uniq.sort.join(",\n") %></td>
			  <td></td>
			  <td><%= Observation.where(:id => Measurement.where(:trait_id => trait.id).map(&:observation_id)).map(&:resource_id).compact.uniq.sort.join(",\n") %></td>
			  <td><%= link_to 'Edit', edit_trait_path(trait), class: "btn btn-default btn-xs" %></td>
			</tr>
		<% end %>
	</table>

		
</small>
